<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:BookTranslator.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="500" d:DesignHeight="300"
        x:Class="BookTranslator.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="PDF to EPUB Translator"
        Width="500" Height="470"
        WindowStartupLocation="CenterScreen">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <StackPanel Margin="20" Spacing="15" VerticalAlignment="Center">
        <TextBlock Text="PDF to EPUB Translator" 
                   FontSize="20" 
                   FontWeight="Bold" 
                   HorizontalAlignment="Center"
                   Margin="0,0,0,10"/>
        
        <Grid ColumnDefinitions="*, Auto">
            <TextBox Grid.Column="0" 
                     Text="{Binding InputFilePath}" 
                     IsReadOnly="True" 
                     Watermark="Select a PDF file..." 
                     Margin="0,0,10,0"/>
            <Button Grid.Column="1" 
                    Content="Browse..." 
                    Command="{Binding SelectFileCommand}"/>
        </Grid>
        
        <StackPanel Orientation="Horizontal" Spacing="10">
            <CheckBox Content="Translate before converting"
                      IsChecked="{Binding TranslateBeforeConvert}"
                      VerticalAlignment="Center"/>
            <ComboBox ItemsSource="{Binding AvailableLanguages}"
                      SelectedItem="{Binding SelectedLanguage}"
                      IsEnabled="{Binding TranslateBeforeConvert}"
                      Width="180"
                      VerticalAlignment="Center"/>
        </StackPanel>
        
        <StackPanel Orientation="Horizontal" Spacing="10">
            <CheckBox Content="Optimize for Kindle (EPUBâ†’AZW3â†’EPUB, requires Calibre)"
                      IsChecked="{Binding ConvertToAzw3}"
                      VerticalAlignment="Center"/>
            <TextBlock Text="âš ï¸ Calibre not found"
                       Foreground="Orange"
                       FontSize="11"
                       VerticalAlignment="Center"
                       IsVisible="{Binding !IsCalibreInstalled}"/>
        </StackPanel>
        
        <Grid ColumnDefinitions="Auto, *, Auto">
            <TextBlock Grid.Column="0" 
                       Text="Output:" 
                       VerticalAlignment="Center"
                       Margin="0,0,10,0"/>
            <TextBox Grid.Column="1" 
                     Text="{Binding OutputDirectory}" 
                     IsReadOnly="True" 
                     Watermark="Same as input file..." 
                     Margin="0,0,10,0"/>
            <Button Grid.Column="2" 
                    Content="ðŸ“" 
                    ToolTip.Tip="Select output folder"
                    Command="{Binding SelectOutputDirectoryCommand}"/>
        </Grid>
        
        <Button Content="Convert to EPUB" 
                Command="{Binding ConvertCommand}" 
                HorizontalAlignment="Stretch" 
                HorizontalContentAlignment="Center"
                Background="#007ACC"
                Foreground="White"
                FontWeight="SemiBold"/>
        
        <Button Content="Send to Kindle"
                Command="{Binding SendToKindleCommand}"
                HorizontalAlignment="Stretch"
                HorizontalContentAlignment="Center"
                Background="#FF9900" 
                Foreground="White"
                FontWeight="SemiBold"/>
        
        <StackPanel IsVisible="{Binding IsBusy}" Spacing="5">
            <ProgressBar Minimum="0" 
                         Maximum="{Binding ProgressMax}" 
                         Value="{Binding ProgressValue}" 
                         Height="10"
                         HorizontalAlignment="Stretch"/>
            <TextBlock Text="{Binding ProgressText}" 
                       HorizontalAlignment="Center" 
                       FontSize="12"/>
        </StackPanel>
        
        <Border BorderBrush="#E0E0E0" BorderThickness="1" Padding="10" MinHeight="40">
            <TextBlock Text="{Binding StatusMessage}" 
                       TextWrapping="Wrap" 
                       HorizontalAlignment="Center"
                       VerticalAlignment="Center"/>
        </Border>
        
        <Button Name="AboutButton"
                Content="â„¹ï¸ About"
                HorizontalAlignment="Center"
                Background="Transparent"
                Foreground="Gray"
                FontSize="12"/>
    </StackPanel>
</Window>
